version: "3.9"

services:
  # Redpanda node 0 (seed)
  redpanda-0:
    image: docker.redpanda.com/redpandadata/redpanda:v25.1.3
    container_name: redpanda-0
    command: >
      redpanda start
      --overprovisioned
      --smp 1
      --memory 1G
      --reserve-memory 0M
      --node-id 0
      --kafka-addr PLAINTEXT://0.0.0.0:9092
      --advertise-kafka-addr PLAINTEXT://redpanda-0:9092
    ports:
      - "19092:9092"
    networks:
      - redpanda_network

  # Redpanda node 1
  redpanda-1:
    image: docker.redpanda.com/redpandadata/redpanda:v25.1.3
    container_name: redpanda-1
    command: >
      redpanda start
      --overprovisioned
      --smp 1
      --memory 1G
      --reserve-memory 0M
      --node-id 1
      --kafka-addr PLAINTEXT://0.0.0.0:9092
      --advertise-kafka-addr PLAINTEXT://redpanda-1:9092
      --seeds redpanda-0:9092
    ports:
      - "29092:9092"
    networks:
      - redpanda_network

  # Redpanda node 2
  redpanda-2:
    image: docker.redpanda.com/redpandadata/redpanda:v25.1.3
    container_name: redpanda-2
    command: >
      redpanda start
      --overprovisioned
      --smp 1
      --memory 1G
      --reserve-memory 0M
      --node-id 2
      --kafka-addr PLAINTEXT://0.0.0.0:9092
      --advertise-kafka-addr PLAINTEXT://redpanda-2:9092
      --seeds redpanda-0:9092
    ports:
      - "39092:9092"
    networks:
      - redpanda_network

  # Redis service
  redis:
    image: redis:latest
    container_name: redis
    ports:
      - "6379:6379"
    networks:
      - redpanda_network

networks:
  redpanda_network:
    driver: bridge
